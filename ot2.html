<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>üê∏ Katak Lompat - Hitungan Daun</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    .frog-hop {
      transition: transform 0.6s cubic-bezier(0.55, -0.2, 0.4, 1.3);
    }
  </style>
</head>
<body class="bg-green-50 text-gray-800 p-6">
  <h1 class="text-2xl font-extrabold mb-4 text-green-800">üê∏ Katak Lompat ‚Äî Hitungan Daun</h1>

  <!-- Input Panel -->
  <div class="flex gap-3 items-center mb-4">
    <label>Angka A: 
      <input id="a" type="number" value="2" class="border rounded px-2 py-1 w-20">
    </label>
    <label>Operator: 
      <select id="op" class="border rounded px-2 py-1">
        <option value="+">+</option>
        <option value="-">-</option>
      </select>
    </label>
    <label>Angka B: 
      <input id="b" type="number" value="3" class="border rounded px-2 py-1 w-20">
    </label>
    <button id="play" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded">Play</button>
    <button id="reset" class="bg-gray-400 hover:bg-gray-500 text-white px-4 py-2 rounded">Reset</button>
  </div>

  <!-- Board -->
  <div class="bg-white p-4 rounded shadow">
    <svg id="board" viewBox="0 0 900 250" preserveAspectRatio="xMidYMid meet" class="w-full h-64">
      <defs>
        <linearGradient id="leafGradient" x1="0" y1="0" x2="0" y2="1">
          <stop offset="0%" stop-color="#4ade80" />
          <stop offset="100%" stop-color="#15803d" />
        </linearGradient>
      </defs>
    </svg>
  </div>

  <!-- Hasil -->
  <div class="mt-3 text-lg">Operasi: 
    <span id="calcText" class="font-bold text-green-700">2 + 3 = 5</span>
  </div>

  <script>
    const svg = document.getElementById('board')
    const aInput = document.getElementById('a')
    const bInput = document.getElementById('b')
    const opInput = document.getElementById('op')
    const playBtn = document.getElementById('play')
    const resetBtn = document.getElementById('reset')
    const calcText = document.getElementById('calcText')

    let frog = null
    let leafPositions = []

    function buildBoard(minVal, maxVal){
      svg.innerHTML = `
        <defs>
          <linearGradient id="leafGradient" x1="0" y1="0" x2="0" y2="1">
            <stop offset="0%" stop-color="#4ade80" />
            <stop offset="100%" stop-color="#15803d" />
          </linearGradient>
        </defs>`
      leafPositions = []

      const axisY = 150
      const width = 860
      const margin = {left:40,right:40}
      const span = maxVal - minVal || 1
      const usable = width - margin.left - margin.right

      function xFor(n){
        return margin.left + (n - minVal) / span * usable
      }

      // Axis
      const axis = document.createElementNS('http://www.w3.org/2000/svg','line')
      axis.setAttribute('x1', xFor(minVal))
      axis.setAttribute('x2', xFor(maxVal))
      axis.setAttribute('y1', axisY)
      axis.setAttribute('y2', axisY)
      axis.setAttribute('stroke', '#333')
      axis.setAttribute('stroke-width', '2')
      svg.appendChild(axis)

      // Leaves
      for(let n = minVal; n <= maxVal; n++){
        const x = xFor(n)
        leafPositions.push({n,x})

        // Bentuk daun pakai path (oval dengan ujung runcing)
        const leafPath = document.createElementNS('http://www.w3.org/2000/svg','path')
        const widthLeaf = 70, heightLeaf = 40
        const d = `
          M ${x - widthLeaf/2} ${axisY+34}
          Q ${x} ${axisY-10} ${x + widthLeaf/2} ${axisY+34}
          Q ${x} ${axisY+34+heightLeaf} ${x - widthLeaf/2} ${axisY+34}
          Z`
        leafPath.setAttribute('d', d)
        leafPath.setAttribute('fill','url(#leafGradient)')
        leafPath.setAttribute('stroke','#166534')
        leafPath.setAttribute('stroke-width','2')
        svg.appendChild(leafPath)

        // Label angka di tengah daun
        const lbl = document.createElementNS('http://www.w3.org/2000/svg','text')
        lbl.setAttribute('x', x)
        lbl.setAttribute('y', axisY+45)
        lbl.setAttribute('text-anchor','middle')
        lbl.setAttribute('font-size','20')
        lbl.setAttribute('font-weight','bold')
        lbl.setAttribute('fill','#ffffff')
        lbl.setAttribute('stroke','#000000')
        lbl.setAttribute('stroke-width','1')
        lbl.textContent = n
        svg.appendChild(lbl)
      }

      // Frog
      const g = document.createElementNS('http://www.w3.org/2000/svg','g')
      g.setAttribute('id','frog')
      g.classList.add('frog-hop')
      svg.appendChild(g)

      const frogText = document.createElementNS('http://www.w3.org/2000/svg','text')
      frogText.setAttribute('x',0)
      frogText.setAttribute('y',10)
      frogText.setAttribute('text-anchor','middle')
      frogText.setAttribute('font-size','28')
      frogText.textContent = 'üê∏'
      g.appendChild(frogText)

      frog = g
    }

    function setFrogAt(n, bounce=false){
      const pos = leafPositions.find(p => p.n === n)
      if(!pos) return
      const yBase = 122
      const yJump = bounce ? 80 : yBase
      frog.setAttribute('transform', `translate(${pos.x}, ${yJump})`)
      if(bounce){
        setTimeout(()=> frog.setAttribute('transform', `translate(${pos.x}, ${yBase})`), 300)
      }
    }

    function updateCalcText(){
      const a = Number(aInput.value)
      const b = Number(bInput.value)
      const op = opInput.value
      const res = (op === '+') ? (a + b) : (a - b)
      calcText.textContent = `${a} ${op} ${b} = ${res}`
    }

    function playAnimation(){
      const a = Number(aInput.value)
      const b = Number(bInput.value)
      const op = opInput.value
      const start = a
      const target = (op === '+') ? (a + b) : (a - b)
      updateCalcText()

      const minVal = Math.min(start, target)
      const maxVal = Math.max(start, target)
      buildBoard(minVal, maxVal)
      setFrogAt(start)

      const path = []
      if(start === target){
        path.push(start)
      } else {
        const step = (target > start) ? 1 : -1
        for(let x = start; x !== target + step; x += step){
          path.push(x)
        }
      }

      let i = 0
      const hopDuration = 600

      function hopTo(index){
        if(index >= path.length) return
        const val = path[index]
        setFrogAt(val, true)
        setTimeout(()=> hopTo(index+1), hopDuration)
      }

      hopTo(0)
    }

    aInput.addEventListener('input', updateCalcText)
    bInput.addEventListener('input', updateCalcText)
    opInput.addEventListener('change', updateCalcText)

    playBtn.addEventListener('click', playAnimation)
    resetBtn.addEventListener('click', ()=>{
      aInput.value = 0; bInput.value = 0; opInput.value = '+'; updateCalcText();
      buildBoard(0,0); setFrogAt(0)
    })

    buildBoard(2,5)
    updateCalcText()
    setFrogAt(Number(aInput.value))
  </script>
</body>
</html>